{"version":3,"file":"react-tinacms-github.cjs.production.min.js","sources":["../../../node_modules/babel-plugin-transform-async-to-promises/helpers.js","../src/github-client/base64.ts","../src/github-client/authenticate.ts","../src/github-client/popupWindow.ts","../src/github-client/github-client.ts","../src/github-client/GithubFile.ts","../src/components/AsyncButton.tsx","../src/github-editing-context/GithubAuthModal.tsx","../src/components/ActionableModal.tsx","../src/github-error/GithubErrorModal.tsx","../src/github-error/github-interpeter.ts","../src/github-editing-context/TinacmsGithubProvider.tsx","../src/toolbar-plugins/pull-request/PRModal.tsx","../src/components/ToolbarButton.tsx","../src/components/DesktopLabel.tsx","../src/toolbar-plugins/pull-request/PRPlugin.tsx","../src/toolbar-plugins/RepoInfoPlugin.tsx","../src/toolbar-plugins/BranchSwitcherPlugin.tsx","../src/toolbar-plugins/createGithubDeleteAction.tsx","../src/form/useGithubFileForm.ts","../src/form/useGithubJsonForm.ts","../src/github-media-store/index.ts","../src/github-media-store/base64File.ts","../src/github-auth/useGithubAuthRedirect.ts","../src/form/useGithubMarkdownForm.ts","../src/toolbar-plugins/useGithubToolbarPlugins.tsx"],"sourcesContent":["// A type of promise-like that resolves synchronously and supports only one observer\nexport const _Pact = /*#__PURE__*/(function() {\n\tfunction _Pact() {}\n\t_Pact.prototype.then = function(onFulfilled, onRejected) {\n\t\tconst result = new _Pact();\n\t\tconst state = this.s;\n\t\tif (state) {\n\t\t\tconst callback = state & 1 ? onFulfilled : onRejected;\n\t\t\tif (callback) {\n\t\t\t\ttry {\n\t\t\t\t\t_settle(result, 1, callback(this.v));\n\t\t\t\t} catch (e) {\n\t\t\t\t\t_settle(result, 2, e);\n\t\t\t\t}\n\t\t\t\treturn result;\n\t\t\t} else {\n\t\t\t\treturn this;\n\t\t\t}\n\t\t}\n\t\tthis.o = function(_this) {\n\t\t\ttry {\n\t\t\t\tconst value = _this.v;\n\t\t\t\tif (_this.s & 1) {\n\t\t\t\t\t_settle(result, 1, onFulfilled ? onFulfilled(value) : value);\n\t\t\t\t} else if (onRejected) {\n\t\t\t\t\t_settle(result, 1, onRejected(value));\n\t\t\t\t} else {\n\t\t\t\t\t_settle(result, 2, value);\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(result, 2, e);\n\t\t\t}\n\t\t};\n\t\treturn result;\n\t}\n\treturn _Pact;\n})();\n\n// Settles a pact synchronously\nexport function _settle(pact, state, value) {\n\tif (!pact.s) {\n\t\tif (value instanceof _Pact) {\n\t\t\tif (value.s) {\n\t\t\t\tif (state & 1) {\n\t\t\t\t\tstate = value.s;\n\t\t\t\t}\n\t\t\t\tvalue = value.v;\n\t\t\t} else {\n\t\t\t\tvalue.o = _settle.bind(null, pact, state);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tif (value && value.then) {\n\t\t\tvalue.then(_settle.bind(null, pact, state), _settle.bind(null, pact, 2));\n\t\t\treturn;\n\t\t}\n\t\tpact.s = state;\n\t\tpact.v = value;\n\t\tconst observer = pact.o;\n\t\tif (observer) {\n\t\t\tobserver(pact);\n\t\t}\n\t}\n}\n\nexport function _isSettledPact(thenable) {\n\treturn thenable instanceof _Pact && thenable.s & 1;\n}\n\n// Converts argument to a function that always returns a Promise\nexport function _async(f) {\n\treturn function() {\n\t\tfor (var args = [], i = 0; i < arguments.length; i++) {\n\t\t\targs[i] = arguments[i];\n\t\t}\n\t\ttry {\n\t\t\treturn Promise.resolve(f.apply(this, args));\n\t\t} catch(e) {\n\t\t\treturn Promise.reject(e);\n\t\t}\n\t}\n}\n\n// Awaits on a value that may or may not be a Promise (equivalent to the await keyword in ES2015, with continuations passed explicitly)\nexport function _await(value, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(value) : value;\n\t}\n\tif (!value || !value.then) {\n\t\tvalue = Promise.resolve(value);\n\t}\n\treturn then ? value.then(then) : value;\n}\n\n// Awaits on a value that may or may not be a Promise, then ignores it\nexport function _awaitIgnored(value, direct) {\n\tif (!direct) {\n\t\treturn value && value.then ? value.then(_empty) : Promise.resolve();\n\t}\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continue(value, then) {\n\treturn value && value.then ? value.then(then) : then(value);\n}\n\n// Proceeds after a value has resolved, or proceeds immediately if the value is not thenable\nexport function _continueIgnored(value) {\n\tif (value && value.then) {\n\t\treturn value.then(_empty);\n\t}\n}\n\n// Asynchronously iterate through an object that has a length property, passing the index as the first argument to the callback (even as the length property changes)\nexport function _forTo(array, body, check) {\n\tvar i = -1, pact, reject;\n\tfunction _cycle(result) {\n\t\ttry {\n\t\t\twhile (++i < array.length && (!check || !check())) {\n\t\t\t\tresult = body(i);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif (pact) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t} else {\n\t\t\t\tpact = result;\n\t\t\t}\n\t\t} catch (e) {\n\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t}\n\t}\n\t_cycle();\n\treturn pact;\n}\n\n// Asynchronously iterate through an object's properties (including properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forIn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tkeys.push(key);\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\n// Asynchronously iterate through an object's own properties (excluding properties inherited from the prototype)\n// Uses a snapshot of the object's properties\nexport function _forOwn(target, body, check) {\n\tvar keys = [];\n\tfor (var key in target) {\n\t\tif (Object.prototype.hasOwnProperty.call(target, key)) {\n\t\t\tkeys.push(key);\n\t\t}\n\t}\n\treturn _forTo(keys, function(i) { return body(keys[i]); }, check);\n}\n\nexport const _iteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.iterator || (Symbol.iterator = Symbol(\"Symbol.iterator\"))) : \"@@iterator\";\n\n// Asynchronously iterate through an object's values\n// Uses for...of if the runtime supports it, otherwise iterates until length on a copy\nexport function _forOf(target, body, check) {\n\tif (typeof target[_iteratorSymbol] === \"function\") {\n\t\tvar iterator = target[_iteratorSymbol](), step, pact, reject;\n\t\tfunction _cycle(result) {\n\t\t\ttry {\n\t\t\t\twhile (!(step = iterator.next()).done && (!check || !check())) {\n\t\t\t\t\tresult = body(step.value);\n\t\t\t\t\tif (result && result.then) {\n\t\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tresult.then(_cycle, reject || (reject = _settle.bind(null, pact = new _Pact(), 2)));\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif (pact) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t} else {\n\t\t\t\t\tpact = result;\n\t\t\t\t}\n\t\t\t} catch (e) {\n\t\t\t\t_settle(pact || (pact = new _Pact()), 2, e);\n\t\t\t}\n\t\t}\n\t\t_cycle();\n\t\tif (iterator.return) {\n\t\t\tvar _fixup = function(value) {\n\t\t\t\ttry {\n\t\t\t\t\tif (!step.done) {\n\t\t\t\t\t\titerator.return();\n\t\t\t\t\t}\n\t\t\t\t} catch(e) {\n\t\t\t\t}\n\t\t\t\treturn value;\n\t\t\t}\n\t\t\tif (pact && pact.then) {\n\t\t\t\treturn pact.then(_fixup, function(e) {\n\t\t\t\t\tthrow _fixup(e);\n\t\t\t\t});\n\t\t\t}\n\t\t\t_fixup();\n\t\t}\n\t\treturn pact;\n\t}\n\t// No support for Symbol.iterator\n\tif (!(\"length\" in target)) {\n\t\tthrow new TypeError(\"Object is not iterable\");\n\t}\n\t// Handle live collections properly\n\tvar values = [];\n\tfor (var i = 0; i < target.length; i++) {\n\t\tvalues.push(target[i]);\n\t}\n\treturn _forTo(values, function(i) { return body(values[i]); }, check);\n}\n\nexport const _asyncIteratorSymbol = /*#__PURE__*/ typeof Symbol !== \"undefined\" ? (Symbol.asyncIterator || (Symbol.asyncIterator = Symbol(\"Symbol.asyncIterator\"))) : \"@@asyncIterator\";\n\n// Asynchronously iterate on a value using it's async iterator if present, or its synchronous iterator if missing\nexport function _forAwaitOf(target, body, check) {\n\tif (typeof target[_asyncIteratorSymbol] === \"function\") {\n\t\tvar pact = new _Pact();\n\t\tvar iterator = target[_asyncIteratorSymbol]();\n\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\treturn pact;\n\t\tfunction _resumeAfterBody(result) {\n\t\t\tif (check && check()) {\n\t\t\t\treturn _settle(pact, 1, iterator.return ? iterator.return().then(function() { return result; }) : result);\n\t\t\t}\n\t\t\titerator.next().then(_resumeAfterNext).then(void 0, _reject);\n\t\t}\n\t\tfunction _resumeAfterNext(step) {\n\t\t\tif (step.done) {\n\t\t\t\t_settle(pact, 1);\n\t\t\t} else {\n\t\t\t\tPromise.resolve(body(step.value)).then(_resumeAfterBody).then(void 0, _reject);\n\t\t\t}\n\t\t}\n\t\tfunction _reject(error) {\n\t\t\t_settle(pact, 2, iterator.return ? iterator.return().then(function() { return error; }) : error);\n\t\t}\n\t}\n\treturn Promise.resolve(_forOf(target, function(value) { return Promise.resolve(value).then(body); }, check));\n}\n\n// Asynchronously implement a generic for loop\nexport function _for(test, update, body) {\n\tvar stage;\n\tfor (;;) {\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t\tif (shouldContinue.then) {\n\t\t\tstage = 0;\n\t\t\tbreak;\n\t\t}\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.s;\n\t\t\t} else {\n\t\t\t\tstage = 1;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tif (update) {\n\t\t\tvar updateValue = update();\n\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\tstage = 2;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n\tvar pact = new _Pact();\n\tvar reject = _settle.bind(null, pact, 2);\n\t(stage === 0 ? shouldContinue.then(_resumeAfterTest) : stage === 1 ? result.then(_resumeAfterBody) : updateValue.then(_resumeAfterUpdate)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tdo {\n\t\t\tif (update) {\n\t\t\t\tupdateValue = update();\n\t\t\t\tif (updateValue && updateValue.then && !_isSettledPact(updateValue)) {\n\t\t\t\t\tupdateValue.then(_resumeAfterUpdate).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\tshouldContinue = test();\n\t\t\tif (!shouldContinue || (_isSettledPact(shouldContinue) && !shouldContinue.v)) {\n\t\t\t\t_settle(pact, 1, result);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t}\n\t\t} while (!result || !result.then);\n\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterBody(result);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n\tfunction _resumeAfterUpdate() {\n\t\tif (shouldContinue = test()) {\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t} else {\n\t\t\t\t_resumeAfterTest(shouldContinue);\n\t\t\t}\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a do ... while loop\nexport function _do(body, test) {\n\tvar awaitBody;\n\tdo {\n\t\tvar result = body();\n\t\tif (result && result.then) {\n\t\t\tif (_isSettledPact(result)) {\n\t\t\t\tresult = result.v;\n\t\t\t} else {\n\t\t\t\tawaitBody = true;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t\tvar shouldContinue = test();\n\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\tshouldContinue = shouldContinue.v;\n\t\t}\n\t\tif (!shouldContinue) {\n\t\t\treturn result;\n\t\t}\n\t} while (!shouldContinue.then);\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : shouldContinue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterBody(value) {\n\t\tresult = value;\n\t\tfor (;;) {\n\t\t\tshouldContinue = test();\n\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t}\n\t\t\tif (!shouldContinue) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (shouldContinue.then) {\n\t\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\tresult = result.v;\n\t\t\t\t} else {\n\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterTest(shouldContinue) {\n\t\tif (shouldContinue) {\n\t\t\tdo {\n\t\t\t\tresult = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tif (_isSettledPact(result)) {\n\t\t\t\t\t\tresult = result.v;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tshouldContinue = test();\n\t\t\t\tif (_isSettledPact(shouldContinue)) {\n\t\t\t\t\tshouldContinue = shouldContinue.v;\n\t\t\t\t}\n\t\t\t\tif (!shouldContinue) {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} while (!shouldContinue.then);\n\t\t\tshouldContinue.then(_resumeAfterTest).then(void 0, reject);\n\t\t} else {\n\t\t\t_settle(pact, 1, result);\n\t\t}\n\t}\n}\n\n// Asynchronously implement a switch statement\nexport function _switch(discriminant, cases) {\n\tvar dispatchIndex = -1;\n\tvar awaitBody;\n\touter: {\n\t\tfor (var i = 0; i < cases.length; i++) {\n\t\t\tvar test = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvar testValue = test();\n\t\t\t\tif (testValue && testValue.then) {\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tif (testValue === discriminant) {\n\t\t\t\t\tdispatchIndex = i;\n\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Found the default case, set it as the pending dispatch case\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tif (dispatchIndex !== -1) {\n\t\t\tdo {\n\t\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\t\twhile (!body) {\n\t\t\t\t\tdispatchIndex++;\n\t\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t\t}\n\t\t\t\tvar result = body();\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tawaitBody = true;\n\t\t\t\t\tbreak outer;\n\t\t\t\t}\n\t\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\t\tdispatchIndex++;\n\t\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t\treturn result;\n\t\t}\n\t}\n\tconst pact = new _Pact();\n\tconst reject = _settle.bind(null, pact, 2);\n\t(awaitBody ? result.then(_resumeAfterBody) : testValue.then(_resumeAfterTest)).then(void 0, reject);\n\treturn pact;\n\tfunction _resumeAfterTest(value) {\n\t\tfor (;;) {\n\t\t\tif (value === discriminant) {\n\t\t\t\tdispatchIndex = i;\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif (++i === cases.length) {\n\t\t\t\tif (dispatchIndex !== -1) {\n\t\t\t\t\tbreak;\n\t\t\t\t} else {\n\t\t\t\t\t_settle(pact, 1, result);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\ttest = cases[i][0];\n\t\t\tif (test) {\n\t\t\t\tvalue = test();\n\t\t\t\tif (value && value.then) {\n\t\t\t\t\tvalue.then(_resumeAfterTest).then(void 0, reject);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\tdispatchIndex = i;\n\t\t\t}\n\t\t}\n\t\tdo {\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tvar result = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tdispatchIndex++;\n\t\t} while (fallthroughCheck && !fallthroughCheck());\n\t\t_settle(pact, 1, result);\n\t}\n\tfunction _resumeAfterBody(result) {\n\t\tfor (;;) {\n\t\t\tvar fallthroughCheck = cases[dispatchIndex][2];\n\t\t\tif (!fallthroughCheck || fallthroughCheck()) {\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tdispatchIndex++;\n\t\t\tvar body = cases[dispatchIndex][1];\n\t\t\twhile (!body) {\n\t\t\t\tdispatchIndex++;\n\t\t\t\tbody = cases[dispatchIndex][1];\n\t\t\t}\n\t\t\tresult = body();\n\t\t\tif (result && result.then) {\n\t\t\t\tresult.then(_resumeAfterBody).then(void 0, reject);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t_settle(pact, 1, result);\n\t}\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _call(body, then, direct) {\n\tif (direct) {\n\t\treturn then ? then(body()) : body();\n\t}\n\ttry {\n\t\tvar result = Promise.resolve(body());\n\t\treturn then ? result.then(then) : result;\n\t} catch (e) {\n\t\treturn Promise.reject(e);\n\t}\n}\n\n// Asynchronously call a function and swallow the result\nexport function _callIgnored(body, direct) {\n\treturn _call(body, _empty, direct);\n}\n\n// Asynchronously call a function and pass the result to explicitly passed continuations\nexport function _invoke(body, then) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(then);\n\t}\n\treturn then(result);\n}\n\n// Asynchronously call a function and swallow the result\nexport function _invokeIgnored(body) {\n\tvar result = body();\n\tif (result && result.then) {\n\t\treturn result.then(_empty);\n\t}\n}\n\n// Asynchronously call a function and send errors to recovery continuation\nexport function _catch(body, recover) {\n\ttry {\n\t\tvar result = body();\n\t} catch(e) {\n\t\treturn recover(e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(void 0, recover);\n\t}\n\treturn result;\n}\n\n// Asynchronously await a promise and pass the result to a finally continuation\nexport function _finallyRethrows(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer(true, e);\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer.bind(null, false), finalizer.bind(null, true));\n\t}\n\treturn finalizer(false, result);\n}\n\n// Asynchronously await a promise and invoke a finally continuation that always overrides the result\nexport function _finally(body, finalizer) {\n\ttry {\n\t\tvar result = body();\n\t} catch (e) {\n\t\treturn finalizer();\n\t}\n\tif (result && result.then) {\n\t\treturn result.then(finalizer, finalizer);\n\t}\n\treturn finalizer();\n}\n\n// Rethrow or return a value from a finally continuation\nexport function _rethrow(thrown, value) {\n\tif (thrown)\n\t\tthrow value;\n\treturn value;\n}\n\n// Empty function to implement break and other control flow that ignores asynchronous results\nexport function _empty() {\n}\n\n// Sentinel value for early returns in generators \nexport const _earlyReturn = /*#__PURE__*/ {};\n\n// Asynchronously call a function and send errors to recovery continuation, skipping early returns\nexport function _catchInGenerator(body, recover) {\n\treturn _catch(body, function(e) {\n\t\tif (e === _earlyReturn) {\n\t\t\tthrow e;\n\t\t}\n\t\treturn recover(e);\n\t});\n}\n\n// Asynchronous generator class; accepts the entrypoint of the generator, to which it passes itself when the generator should start\nexport const _AsyncGenerator = /*#__PURE__*/(function() {\n\tfunction _AsyncGenerator(entry) {\n\t\tthis._entry = entry;\n\t\tthis._pact = null;\n\t\tthis._resolve = null;\n\t\tthis._return = null;\n\t\tthis._promise = null;\n\t}\n\n\tfunction _wrapReturnedValue(value) {\n\t\treturn { value: value, done: true };\n\t}\n\tfunction _wrapYieldedValue(value) {\n\t\treturn { value: value, done: false };\n\t}\n\n\t_AsyncGenerator.prototype._yield = function(value) {\n\t\t// Yield the value to the pending next call\n\t\tthis._resolve(value && value.then ? value.then(_wrapYieldedValue) : _wrapYieldedValue(value));\n\t\t// Return a pact for an upcoming next/return/throw call\n\t\treturn this._pact = new _Pact();\n\t};\n\t_AsyncGenerator.prototype.next = function(value) {\n\t\t// Advance the generator, starting it if it has yet to be started\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tconst _entry = _this._entry;\n\t\t\t\tif (_entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the next call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Start the generator\n\t\t\t\t_this._entry = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\tfunction returnValue(value) {\n\t\t\t\t\t_this._resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t_this._resolve = null;\n\t\t\t\t}\n\t\t\t\tvar result = _entry(_this);\n\t\t\t\tif (result && result.then) {\n\t\t\t\t\tresult.then(returnValue, function(error) {\n\t\t\t\t\t\tif (error === _earlyReturn) {\n\t\t\t\t\t\t\treturnValue(_this._return);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tconst pact = new _Pact();\n\t\t\t\t\t\t\t_this._resolve(pact);\n\t\t\t\t\t\t\t_this._pact = null;\n\t\t\t\t\t\t\t_this._resolve = null;\n\t\t\t\t\t\t\t_resolve(pact, 2, error);\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\treturnValue(result);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Generator is started and a yield expression is pending, settle it\n\t\t\t\t_this._pact = null;\n\t\t\t\t_this._resolve = resolve;\n\t\t\t\t_settle(_pact, 1, value);\n\t\t\t}\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.return = function(value) {\n\t\t// Early return from the generator if started, otherwise abandons the generator\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the return call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return the specified value\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn resolve(value && value.then ? value.then(_wrapReturnedValue) : _wrapReturnedValue(value));\n\t\t\t}\n\t\t\t// Settle the yield expression with a rejected \"early return\" value\n\t\t\t_this._return = value;\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, _earlyReturn);\n\t\t});\n\t};\n\t_AsyncGenerator.prototype.throw = function(error) {\n\t\t// Inject an exception into the pending yield expression\n\t\tconst _this = this;\n\t\treturn _this._promise = new Promise(function (resolve, reject) {\n\t\t\tconst _pact = _this._pact;\n\t\t\tif (_pact === null) {\n\t\t\t\tif (_this._entry === null) {\n\t\t\t\t\t// Generator is started, but not awaiting a yield expression\n\t\t\t\t\t// Abandon the throw call!\n\t\t\t\t\treturn resolve(_this._promise);\n\t\t\t\t}\n\t\t\t\t// Generator is not started, abandon it and return a rejected Promise containing the error\n\t\t\t\t_this._entry = null;\n\t\t\t\treturn reject(error);\n\t\t\t}\n\t\t\t// Settle the yield expression with the value as a rejection\n\t\t\t_this._resolve = resolve;\n\t\t\t_this._pact = null;\n\t\t\t_settle(_pact, 2, error);\n\t\t});\n\t};\n\n\t_AsyncGenerator.prototype[_asyncIteratorSymbol] = function() {\n\t\treturn this;\n\t};\n\t\n\treturn _AsyncGenerator;\n})();\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nconst btoa = require('btoa')\n\nexport const b64EncodeUnicode = (str: string) => {\n  // first we use encodeURIComponent to get percent-encoded UTF-8,\n  // then we convert the percent encodings into raw bytes which\n  // can be fed into btoa.\n  return btoa(\n    encodeURIComponent(str).replace(/%([0-9A-F]{2})/g, function toSolidBytes(\n      _match,\n      p1\n    ) {\n      return String.fromCharCode(parseInt(p1, 16))\n    })\n  )\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport popupWindow from './popupWindow'\nexport const GITHUB_AUTH_CODE_KEY = 'github_auth_code'\nexport const authenticate = (\n  clientId: string,\n  codeExchangeRoute: string,\n  scope: string = 'public_repo'\n): Promise<void> => {\n  const authState = Math.random()\n    .toString(36)\n    .substring(7)\n\n  const url = `https://github.com/login/oauth/authorize?scope=${scope}&client_id=${clientId}&state=${authState}`\n\n  return new Promise(resolve => {\n    // @ts-ignore\n    let authTab: Window | undefined\n    window.addEventListener('storage', function(e: StorageEvent) {\n      if (e.key == GITHUB_AUTH_CODE_KEY) {\n        fetch(`${codeExchangeRoute}?code=${e.newValue}&state=${authState}`)\n          .then(response => response.json())\n          .then(data => {\n            const token = data.signedToken || null\n            if (token) {\n              // for implementations using the csrf mitigation\n              localStorage.setItem('tinacms-github-token', token)\n            } else {\n              console.warn(\n                'Deprecation Notice: You are using an old authentication flow, please migrate to the new one (see https://tinacms.org/blog/upgrade-notice-improved-github-security)'\n              )\n            }\n            if (authTab) {\n              authTab.close()\n            }\n            resolve()\n          })\n      }\n    })\n    authTab = popupWindow(url, '_blank', window, 1000, 700)\n  })\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nfunction popupWindow(\n  url: string,\n  title: string,\n  window: any,\n  w: number,\n  h: number\n): Window {\n  const y = window.top.outerHeight / 2 + window.top.screenY - h / 2\n  const x = window.top.outerWidth / 2 + window.top.screenX - w / 2\n  return window.open(\n    url,\n    title,\n    'toolbar=no, location=no, directories=no, status=no, menubar=no, scrollbars=yes, resizable=yes, copyhistory=no, width=' +\n      w +\n      ', height=' +\n      h +\n      ', top=' +\n      y +\n      ', left=' +\n      x\n  )\n}\n\nexport default popupWindow\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { b64EncodeUnicode } from './base64'\nimport Cookies from 'js-cookie'\nimport { authenticate } from './authenticate'\nexport * from './authenticate'\n\nexport interface GithubClientOptions {\n  proxy: string\n  clientId: string\n  authCallbackRoute: string\n  baseRepoFullName: string\n  baseBranch?: string\n  authScope?: AuthScope\n}\n\nexport interface Branch {\n  name: string\n  protected: boolean\n}\n\nexport type AuthScope = 'public_repo' | 'repo'\n\nfunction removeLeadingSlash(path: string) {\n  if (path.charAt(0) === '/') {\n    return path.substring(1)\n  }\n  return path\n}\n\nexport class GithubClient {\n  static WORKING_REPO_COOKIE_KEY = 'working_repo_full_name'\n  static HEAD_BRANCH_COOKIE_KEY = 'head_branch'\n\n  proxy: string\n  baseRepoFullName: string\n  baseBranch: string\n  clientId: string\n  authCallbackRoute: string\n  authScope: AuthScope\n\n  constructor({\n    proxy,\n    clientId,\n    authCallbackRoute,\n    baseRepoFullName,\n    baseBranch = 'master',\n    authScope = 'public_repo',\n  }: GithubClientOptions) {\n    this.proxy = proxy\n    this.baseRepoFullName = baseRepoFullName\n    this.baseBranch = baseBranch\n    this.clientId = clientId\n    this.authCallbackRoute = authCallbackRoute\n    this.authScope = authScope\n    this.validate()\n  }\n\n  authenticate() {\n    return authenticate(this.clientId, this.authCallbackRoute, this.authScope)\n  }\n\n  isAuthenticated() {\n    return this.getUser()\n  }\n\n  get isFork() {\n    return this.workingRepoFullName !== this.baseRepoFullName\n  }\n\n  async isAuthorized(): Promise<boolean> {\n    try {\n      const repo = await this.getRepository()\n\n      return repo.permissions.push\n    } catch {\n      return false\n    }\n  }\n\n  async getUser() {\n    try {\n      const data = await this.req({\n        url: `https://api.github.com/user`,\n        method: 'GET',\n      })\n\n      return data\n    } catch (e) {\n      if ((e.status = 401)) {\n        return\n      }\n      throw e\n    }\n  }\n\n  getRepository() {\n    return this.req({\n      url: `https://api.github.com/repos/${this.workingRepoFullName}`,\n    })\n  }\n\n  async createFork() {\n    const fork = await this.req({\n      url: `https://api.github.com/repos/${this.baseRepoFullName}/forks`,\n      method: 'POST',\n    })\n\n    this.setCookie(GithubClient.WORKING_REPO_COOKIE_KEY, fork.full_name)\n\n    return fork\n  }\n\n  createPR(title: string, body: string) {\n    const workingRepoFullName = this.workingRepoFullName\n    const headBranch = this.branchName\n\n    return this.req({\n      url: `https://api.github.com/repos/${this.baseRepoFullName}/pulls`,\n      method: 'POST',\n      data: {\n        title: title ? title : 'Update from TinaCMS',\n        body: body ? body : 'Please pull these awesome changes in!',\n        head: `${workingRepoFullName.split('/')[0]}:${headBranch}`,\n        base: this.baseBranch,\n      },\n    })\n  }\n\n  get workingRepoFullName(): string {\n    const forkName = this.getCookie(GithubClient.WORKING_REPO_COOKIE_KEY)\n\n    if (forkName) {\n      return forkName\n    }\n\n    return this.baseRepoFullName\n  }\n\n  setWorkingRepoFullName(repoFullName: string) {\n    this.setCookie(GithubClient.WORKING_REPO_COOKIE_KEY, repoFullName)\n  }\n\n  get branchName(): string {\n    const branchName = this.getCookie(GithubClient.HEAD_BRANCH_COOKIE_KEY)\n\n    if (branchName) {\n      return branchName\n    }\n\n    return this.baseBranch\n  }\n\n  setWorkingBranch(branch: string) {\n    this.setCookie(GithubClient.HEAD_BRANCH_COOKIE_KEY, branch)\n  }\n\n  async fetchExistingPR() {\n    const workingRepoFullName = this.workingRepoFullName\n    const headBranch = this.branchName\n\n    const branches = await this.req({\n      url: `https://api.github.com/repos/${this.baseRepoFullName}/pulls`,\n      method: 'GET',\n    })\n\n    for (let i = 0; i < branches.length; i++) {\n      const pull = branches[i]\n      if (headBranch === pull.head.ref) {\n        if (\n          pull.head.repo?.full_name === workingRepoFullName &&\n          pull.base.repo?.full_name === this.baseRepoFullName\n        ) {\n          return pull // found matching PR\n        }\n      }\n    }\n\n    return\n  }\n\n  async getBranch() {\n    try {\n      const workingRepoFullName = this.workingRepoFullName\n      const branch = this.branchName\n\n      const data = await this.req({\n        url: `https://api.github.com/repos/${workingRepoFullName}/git/ref/heads/${branch}`,\n        method: 'GET',\n      })\n      return data\n    } catch (e) {\n      if ((e.status = 404)) {\n        return\n      }\n      throw e\n    }\n\n    // TODO\n    // if (data.ref.startsWith('refs/heads/')) {\n    //   //check if branch, and not tag\n    //   return data\n    // }\n    // return // Bubble up error here?\n  }\n\n  async getBranchList(): Promise<Branch[]> {\n    return await this.req({\n      url: `https://api.github.com/repos/${this.workingRepoFullName}/branches`,\n      method: 'GET',\n    })\n  }\n\n  async createBranch(name: string) {\n    console.log(\"creating branchhhh\")\n    const currentBranch = await this.getBranch()\n    const sha = currentBranch.object.sha\n    return this.req({\n      url: `https://api.github.com/repos/${this.workingRepoFullName}/git/refs`,\n      method: 'POST',\n      data: {\n        ref: `refs/heads/${name}`,\n        sha,\n      },\n    })\n  }\n\n  async commit(\n    filePath: string,\n    sha: string,\n    fileContents: string,\n    commitMessage: string = 'Update from TinaCMS'\n  ) {\n    const repo = this.workingRepoFullName\n    const branch = this.branchName\n\n    return this.req({\n      url: `https://api.github.com/repos/${repo}/contents/${removeLeadingSlash(\n        filePath\n      )}`,\n      method: 'PUT',\n      data: {\n        message: commitMessage,\n        content: b64EncodeUnicode(fileContents),\n        sha,\n        branch: branch,\n      },\n    })\n  }\n\n  async getDownloadUrl(path: string): Promise<string> {\n    const res = await this.fetchFile(path, false)\n    return res.download_url\n  }\n\n  async fetchFile(filePath: string, decoded: boolean = true) {\n    const repo = this.workingRepoFullName\n    const branch = this.branchName\n    const request = await this.req({\n      url: `https://api.github.com/repos/${repo}/contents/${removeLeadingSlash(\n        filePath\n      )}?ref=${branch}`,\n      method: 'GET',\n    })\n\n    // decode using base64 decoding (https://developer.mozilla.org/en-US/docs/Glossary/Base64)\n    request.content = decoded ? atob(request.content || '') : request.content\n    return request\n  }\n\n  /*\n  added or deletes files from github\n  */\n  async githubFileApi(\n    path: string,\n    fileContents: string,\n    commitMessage: string = 'Update from TinaCMS',\n    encoded: boolean = false,\n    method: 'PUT' | 'DELETE'\n  ) {\n    const repo = this.workingRepoFullName\n    const branch = this.branchName\n\n    let sha = null\n    try {\n      ;({ sha } = await this.fetchFile(path))\n    } catch (e) {}\n\n    return this.req({\n      url: `https://api.github.com/repos/${repo}/contents/${removeLeadingSlash(\n        path\n      )}`,\n      method,\n      data: {\n        message: commitMessage,\n        content: encoded ? fileContents : b64EncodeUnicode(fileContents),\n        branch: branch,\n        sha,\n      },\n    })\n  }\n\n  async upload(\n    path: string,\n    fileContents: string,\n    commitMessage: string = 'Update from TinaCMS',\n    encoded: boolean = false\n  ) {\n    return this.githubFileApi(path, fileContents, commitMessage, encoded, 'PUT')\n  }\n\n  async delete(\n    path: string,\n    commitMessage: string = `Deleted ${path} using TinaCMS`\n  ) {\n    return this.githubFileApi(path, '', commitMessage, false, 'DELETE')\n  }\n\n  protected async req(data: any) {\n    const response = await this.proxyRequest(data)\n    console.log(response)\n    return this.getGithubResponse(response)\n  }\n\n  protected async getGithubResponse(response: Response) {\n    const data = await response.json()\n    //2xx status codes\n    if (response.status.toString()[0] == '2') return data\n\n    throw new GithubError(data.message || response.statusText, response.status)\n  }\n\n  private validate(): void {\n    const errors = []\n    if (!this.proxy) {\n      errors.push('Missing `proxy` URL')\n    }\n    if (!this.authCallbackRoute) {\n      errors.push('Missing `authCallbackRoute`')\n    }\n    if (!this.baseRepoFullName) {\n      errors.push(\n        'Missing `baseRepoFullName`. It may not have been set in environment variables.'\n      )\n    }\n    if (!this.clientId) {\n      errors.push(\n        'Missing `clientId`. It may not have been set in environment variables.'\n      )\n    }\n    if (errors.length) {\n      throw new Error(createErrorMessage(errors))\n    }\n  }\n\n  /**\n   * The methods below maybe don't belong on GitHub client, but it's fine for now.\n   */\n  private proxyRequest(data: any) {\n    // For implementations using the csrf mitigation\n    // const token = localStorage.getItem('tinacms-github-token') || null\n    const token = localStorage.getItem('github-access-token') || null\n    console.log('github-access-token', token)\n    const headers = new Headers()\n\n    if (token) {\n      headers.append('Authorization', 'token ' + token)\n    } else {\n      console.warn(\n        'Deprecation Notice: You are using an old authentication flow, please migrate to the new one (see https://tinacms.org/blog/upgrade-notice-improved-github-security)'\n      )\n    }\n    console.log('proxy urll', this.proxy)\n    return fetch(this.proxy, {\n      method: 'POST',\n      headers: headers,\n      body: JSON.stringify(data),\n    })\n  }\n\n  private getCookie(cookieName: string): string | undefined {\n    return Cookies.get(cookieName)\n  }\n\n  private setCookie(cookieName: string, val: string) {\n    Cookies.set(cookieName, val, { sameSite: 'strict' })\n  }\n}\n\nclass GithubError extends Error {\n  status: number\n  constructor(message: string, status: number) {\n    super(message)\n    this.message = message\n    this.status = status\n  }\n}\n\nconst createErrorMessage = (\n  errors: string[]\n) => `Failed to create the TinaCMS GithubClient\n\n${errors.map(error => `\\t* ${error}`).join('\\n')}\n\nVisit the setup guide for more information\n\n\\thttps://tinacms.org/guides/nextjs/github-open-authoring/configure-custom-app\n`\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { useMemo } from 'react'\nimport { useCMS } from '@tinacms/react-core'\n\ntype parseFn = (content: string) => any\ntype serializeFn = (data: any) => string\n\nexport class GithubFile {\n  private sha: string | null = null\n\n  constructor(\n    private cms: any,\n    private path: string,\n    private parse?: parseFn,\n    private serialize?: serializeFn\n  ) {}\n\n  fetchFile = async () => {\n    const res = await this.cms.api.github.fetchFile(this.path)\n    this.sha = res.sha\n    return this.parse ? this.parse(res.content) : res.content\n  }\n\n  commit = async (\n    data: any,\n    message: string = 'Update from TinaCMS',\n    retryOnConflict = true\n  ) => {\n    const serializedContent = this.serialize ? this.serialize(data) : data\n    try {\n      if (!this.sha) {\n        const res = await this.cms.api.github.fetchFile(this.path)\n        this.sha = res.sha\n      }\n      const response = await this.cms.api.github.commit(\n        this.path,\n        this.sha,\n        serializedContent,\n        message\n      )\n      this.sha = response.content.sha\n      this.cms.events.dispatch({ type: 'github:commit', response })\n      return response\n    } catch (error) {\n      if (error.status == 409 && retryOnConflict) {\n        await this.fetchFile() // update sha\n        await this.commit(data, message, false) // try one more time\n      } else {\n        this.cms.events.dispatch({ type: 'github:error', error })\n        throw error\n      }\n    }\n  }\n}\n\nexport const useGithubFile = ({\n  path,\n  parse,\n  serialize,\n}: {\n  path: string\n  parse?: parseFn\n  serialize?: serializeFn\n}) => {\n  const cms = useCMS()\n  return useMemo(() => {\n    return new GithubFile(cms, path, parse, serialize)\n  }, [path, parse, serialize, cms])\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport React, { useCallback, useState } from 'react'\nimport { LoadingDots } from '@tinacms/react-forms'\nimport { Button } from '@tinacms/styles'\n\ninterface ButtonProps {\n  name: string\n  action(): Promise<void>\n  primary: boolean\n}\n\nexport const AsyncButton = ({ name, primary, action }: ButtonProps) => {\n  const [submitting, setSubmitting] = useState(false)\n\n  const onClick = useCallback(async () => {\n    setSubmitting(true)\n    try {\n      await action()\n      setSubmitting(false)\n    } catch (e) {\n      setSubmitting(false)\n      throw e\n    }\n  }, [action, setSubmitting])\n\n  return (\n    <Button\n      primary={primary}\n      onClick={onClick}\n      busy={submitting}\n      disabled={submitting}\n    >\n      {submitting && <LoadingDots />}\n      {!submitting && name}\n    </Button>\n  )\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport {\n  useCMS,\n  Modal,\n  ModalPopup,\n  ModalHeader,\n  ModalBody,\n  ModalActions,\n} from 'tinacms'\nimport { StyleReset } from '@tinacms/styles'\nimport { AsyncButton } from '../components/AsyncButton'\nimport React, { useState } from 'react'\nimport styled from 'styled-components'\n\nexport interface GithubAuthenticationModalProps {\n  onAuthSuccess(): void\n  close(): void\n}\n\nexport function GithubAuthenticationModal({\n  onAuthSuccess,\n  close,\n}: GithubAuthenticationModalProps) {\n  const cms = useCMS()\n  return (\n    <ModalBuilder\n      title=\"GitHub Authorization\"\n      message=\"To save edits, Tina requires GitHub authorization. On save, changes will get commited to GitHub using your account.\"\n      close={close}\n      actions={[\n        {\n          name: 'Cancel',\n          action: close,\n        },\n        {\n          name: 'Continue to GitHub',\n          action: async () => {\n            await cms.api.github.authenticate()\n            onAuthSuccess()\n          },\n          primary: true,\n        },\n      ]}\n    />\n  )\n}\n\nexport interface CreateForkModalProps {\n  onForkCreated(): void\n  close(): void\n}\n\nexport function CreateForkModal({\n  onForkCreated,\n  close,\n}: CreateForkModalProps) {\n  const cms = useCMS()\n  const [error, setError] = useState<string | undefined>()\n  return (\n    <ModalBuilder\n      title=\"GitHub Authorization\"\n      message=\"A fork of this website is required to save changes.\"\n      close={close}\n      actions={[\n        {\n          name: 'Cancel',\n          action: close,\n        },\n        {\n          name: 'Create Fork',\n          action: async () => {\n            try {\n              await cms.api.github.createFork()\n              onForkCreated()\n            } catch (e) {\n              setError(\n                'Forking repository failed. Are you sure the repository is public?'\n              )\n              throw e\n            }\n          },\n          primary: true,\n        },\n      ]}\n      error={error}\n    />\n  )\n}\n\ninterface ModalBuilderProps {\n  title: string\n  message: string\n  error?: string\n  actions: any[]\n  close(): void\n}\n\nexport function ModalBuilder(modalProps: ModalBuilderProps) {\n  return (\n    <StyleReset>\n      <Modal>\n        <ModalPopup>\n          <ModalHeader close={modalProps.close}>{modalProps.title}</ModalHeader>\n          <ModalBody padded>\n            <p>{modalProps.message}</p>\n            {modalProps.error && <ErrorLabel>{modalProps.error}</ErrorLabel>}\n          </ModalBody>\n          <ModalActions>\n            {modalProps.actions.map((action: any) => (\n              <AsyncButton {...action} />\n            ))}\n          </ModalActions>\n        </ModalPopup>\n      </Modal>\n    </StyleReset>\n  )\n}\n\nexport const ErrorLabel = styled.p`\n  color: var(--tina-color-error) !important;\n`\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport React from 'react'\nimport { StyleReset, Button as TinaButton } from '@tinacms/styles'\nimport {\n  Modal,\n  ModalPopup,\n  ModalBody,\n  ModalActions,\n  ModalHeader,\n} from 'tinacms'\n\nexport interface ActionableModalOptions {\n  title: string\n  message: string\n  actions: Array<{ name: string; action(): void; primary?: boolean }>\n}\n\nexport const ActionableModal = ({\n  title,\n  message,\n  actions,\n}: ActionableModalOptions) => {\n  if (!open) {\n    return null\n  }\n\n  return (\n    <StyleReset>\n      <Modal>\n        <ModalPopup>\n          <ModalHeader>{title}</ModalHeader>\n          <ModalBody padded>\n            <p>{message}</p>\n          </ModalBody>\n          <ModalActions>\n            {actions.map(action => (\n              <TinaButton primary={action.primary} onClick={action.action}>\n                {action.name}\n              </TinaButton>\n            ))}\n          </ModalActions>\n        </ModalPopup>\n      </Modal>\n    </StyleReset>\n  )\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport React, { useEffect, useState } from 'react'\nimport { useCMS } from 'tinacms'\nimport { getModalProps } from './github-interpeter'\nimport {\n  ActionableModalOptions,\n  ActionableModal,\n} from '../components/ActionableModal'\n\nexport interface GithubError extends Error {\n  status: number\n  message: string\n}\n\ninterface Props {\n  error: GithubError\n}\n\n// When an open authoring error is caught, we don't immedietly know the cause\n// We have to perform a few extra checks and render a modal with options\nconst GithubErrorModal = (props: Props) => {\n  const [\n    errorModalProps,\n    setErrorModalProps,\n  ] = useState<ActionableModalOptions | null>(null)\n  const { github } = useCMS().api\n\n  const cms = useCMS()\n\n  useEffect(() => {\n    ;(async () => {\n      if (props.error) {\n        const modalProps = await getModalProps(\n          props.error,\n          cms,\n          github,\n          cms.enable,\n          cms.disable\n        )\n        setErrorModalProps(modalProps)\n      } else {\n        setErrorModalProps(null)\n      }\n    })()\n  }, [props.error, cms.enable])\n\n  if (!errorModalProps) {\n    return null\n  }\n\n  return <ActionableModal {...errorModalProps} />\n}\n\nexport default GithubErrorModal\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { ActionableModalOptions } from '../components/ActionableModal'\nimport { GithubClient } from '../github-client'\nimport { TinaCMS } from 'tinacms'\n\nexport const getModalProps = async (\n  error: any,\n  cms: TinaCMS,\n  githubClient: GithubClient,\n  startEditing: () => void,\n  stopEditing: () => void\n): Promise<ActionableModalOptions> => {\n  const reauthenticateAction = {\n    name: 'Continue',\n    primary: true,\n    action: startEditing,\n  }\n  const cancelEditModeAction = {\n    name: 'Cancel',\n    primary: false,\n    action: stopEditing,\n  }\n  const switchToMaster = {\n    name: `Switch to ${githubClient.baseBranch}`,\n    primary: true,\n    action: () => {\n      githubClient.setWorkingBranch(githubClient.baseBranch)\n      cms.events.dispatch({\n        type: 'github:branch:checkout',\n        branchName: githubClient.baseBranch,\n      })\n    },\n  }\n\n  switch (error.status) {\n    case 401: {\n      // Unauthorized\n      return {\n        title: '401 Unauthenticated',\n        message: 'Authentication is invalid',\n        actions: [cancelEditModeAction, reauthenticateAction],\n      }\n    }\n    case 404: {\n      /**\n       * This case checks all the reasons there may have been a 404:\n       * - Unauthorized\n       *   - Private Repo\n       *   - Missing Repo\n       * - Missing Branch\n       * - Missing Repo\n       */\n\n      // Is the user authorized to edit this repo?\n      if (!(await githubClient.isAuthorized())) {\n        // Is the repo public?\n        if (githubClient.authScope === 'public_repo') {\n          return {\n            title: `Create a Fork of ${githubClient.baseRepoFullName}`,\n            message:\n              `You do not have permission to make changes to ${githubClient.baseRepoFullName}.` +\n              `Press the button below to fork this site and begin editing. `,\n            actions: [\n              cancelEditModeAction,\n              {\n                name: 'Create a Fork',\n                primary: true,\n                action: startEditing,\n              },\n            ],\n          }\n        } else {\n          return {\n            title: 'Unauthorized',\n            message: `You do not have permission to make changes to ${githubClient.baseRepoFullName}.`,\n            actions: [cancelEditModeAction],\n          }\n        }\n      }\n\n      // Does the branch exist?\n      if (await githubClient.getBranch()) {\n        return {\n          title: 'Missing Branch ',\n          message: 'The branch that you were editing has been deleted. Press.',\n          actions: [cancelEditModeAction, switchToMaster],\n        }\n      }\n\n      // The file is missing\n      return {\n        title: 'Content Not Found.',\n        message:\n          'The file you are trying to access is missing. Maybe it lives on a different branch?',\n        actions: [cancelEditModeAction, switchToMaster],\n      }\n    }\n    case 500: {\n      return {\n        title: 'Error 500',\n        message: error.message,\n        actions: [reauthenticateAction],\n      }\n    }\n  }\n\n  return {\n    title: `Error  ${error.status}`,\n    message: error.message,\n    actions: [cancelEditModeAction, reauthenticateAction],\n  }\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport React, { useState, useEffect } from 'react'\nimport { useCMS } from 'tinacms'\nimport GithubErrorModal, { GithubError } from '../github-error/GithubErrorModal'\nimport { CreateForkModal, GithubAuthenticationModal } from './GithubAuthModal'\nimport { GithubClient } from '../github-client'\n\ninterface ProviderProps {\n  children: any\n  onLogin: () => void\n  onLogout: () => void\n  error?: any\n}\n\ntype ModalNames = null | 'authenticate' | 'createFork'\n\nexport const TinacmsGithubProvider = ({\n  children,\n  onLogin,\n  onLogout,\n  error: previewError,\n}: ProviderProps) => {\n  const [error, setError] = useState<GithubError>(previewError)\n  const cms = useCMS()\n  const github: GithubClient = cms.api.github\n  const [activeModal, setActiveModal] = useState<ModalNames>(null)\n\n  const onClose = async () => {\n    setActiveModal(null)\n    if (!(await github.isAuthorized())) {\n      cms.disable()\n    }\n  }\n\n  const beginAuth = async () => {\n    if (await github.isAuthenticated()) {\n      onAuthSuccess()\n    } else {\n      setActiveModal('authenticate')\n    }\n  }\n\n  const onAuthSuccess = async () => {\n    if (await github.isAuthorized()) {\n      github.setWorkingRepoFullName(github.baseRepoFullName)\n      github.setWorkingBranch(github.branchName)\n      onLogin()\n      setActiveModal(null)\n    } else {\n      setActiveModal('createFork')\n    }\n  }\n\n  useCMSEvent('cms:enable', beginAuth, [])\n  useCMSEvent('cms:disable', onLogout, [])\n  useCMSEvent('github:branch:checkout', onLogin, [])\n  useCMSEvent('github:error', ({ error }: any) => setError(error), [])\n\n  return (\n    <>\n      {error && <GithubErrorModal error={error} />}\n      {!error && activeModal === 'authenticate' && (\n        <GithubAuthenticationModal\n          close={onClose}\n          onAuthSuccess={onAuthSuccess}\n        />\n      )}\n      {!error && activeModal === 'createFork' && (\n        <CreateForkModal close={onClose} onForkCreated={onLogin} />\n      )}\n      {!previewError && children}\n    </>\n  )\n}\n\nfunction useCMSEvent(event: string, callback: any, deps: React.DependencyList) {\n  const cms = useCMS()\n  useEffect(function() {\n    return cms.events.subscribe(event, callback)\n  }, deps)\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { Button as RawTinaButton } from '@tinacms/styles'\nimport { Input, TextArea } from '@tinacms/fields'\nimport { ModalBody, ModalActions, FieldMeta, useCMS } from 'tinacms'\nimport styled from 'styled-components'\nimport React, { useEffect, useState } from 'react'\nimport { AsyncButton } from '../../components/AsyncButton'\nimport { GithubClient } from '../../github-client'\n\nexport const PRModal = () => {\n  const [prError, setPrError] = useState('')\n  const [fetchedPR, setFetchedPR] = useState<any>(undefined)\n  const cms = useCMS()\n  const github: GithubClient = cms.api.github\n\n  const titleInput = React.createRef() as any\n  const bodyInput = React.createRef() as any\n\n  const checkForPR = async () => {\n    await github\n      .fetchExistingPR()\n      .then((pull: any) => {\n        if (pull) {\n          setFetchedPR(pull)\n        } else {\n          setFetchedPR({ id: null })\n        }\n      })\n      .catch(() => {\n        setPrError(`Could not fetch Pull Requests`)\n      })\n  }\n\n  const createPR = () => {\n    return github\n      .createPR(titleInput.current.value, bodyInput.current.value)\n      .then(() => {\n        checkForPR() // TODO - can we use PR from response instead of refetching?\n      })\n      .catch(() => {\n        setPrError(`Pull Request failed, are you sure you have any changes?`)\n      })\n  }\n\n  useEffect(() => {\n    checkForPR()\n  }, [])\n\n  if (prError) {\n    return (\n      <PrModalBody>\n        <ModalDescription>\n          <p>{prError}</p>\n        </ModalDescription>\n      </PrModalBody>\n    )\n  }\n\n  if (!fetchedPR) {\n    return (\n      <PrModalBody>\n        <ModalDescription>\n          <p>Loading...</p>\n        </ModalDescription>\n      </PrModalBody>\n    )\n  }\n\n  let workingBranch = github.branchName\n  let baseBranch = github.baseBranch\n\n  if (github.isFork) {\n    const username = github.workingRepoFullName.split('/')[0]\n    const baseOwner = github.baseRepoFullName.split('/')[0]\n    workingBranch = `${username}:${workingBranch}`\n    baseBranch = `${baseOwner}:${baseBranch}`\n  }\n\n  if (workingBranch === baseBranch) {\n    return (\n      <PrModalBody>\n        <ModalDescription>\n          <p>\n            You are currently on the base branch: <b>{baseBranch}</b>.\n          </p>\n          <p>To create a Pull Request you must first switch to a new branch.</p>\n        </ModalDescription>\n      </PrModalBody>\n    )\n  }\n\n  return (\n    <>\n      <PrModalBody>\n        {!fetchedPR.id && (\n          <>\n            <ModalDescription>\n              Create a pull request from <b>{workingBranch}</b> into{' '}\n              <b>{baseBranch}</b>.{' '}\n              <a\n                target=\"_blank\"\n                href={`https://github.com/${github.baseRepoFullName}/compare/${\n                  github.baseBranch\n                }...${github.workingRepoFullName.split('/')[0]}:${\n                  github.branchName\n                }`}\n              >\n                View changes on GitHub\n              </a>\n              .\n            </ModalDescription>\n            <FieldMeta label=\"PR Title\" name=\"title\">\n              <Input type=\"text\" ref={titleInput} />\n            </FieldMeta>\n            <FieldMeta label=\"PR Description\" name=\"description\">\n              <TextArea ref={bodyInput} />\n            </FieldMeta>\n          </>\n        )}\n        {fetchedPR.id && (\n          <ModalDescription>\n            You've created a pull request from <b>{workingBranch}</b> into{' '}\n            <b>{baseBranch}</b>.\n          </ModalDescription>\n        )}\n      </PrModalBody>\n      <ModalActions>\n        {!fetchedPR.id && (\n          <AsyncButton primary name=\"Create Pull Request\" action={createPR} />\n        )}\n        {fetchedPR && fetchedPR.html_url && (\n          <>\n            <TinaButton\n              as=\"a\"\n              // @ts-ignore\n              href={`https://github.com/${github.baseRepoFullName}/compare/${\n                github.baseBranch\n              }...${github.workingRepoFullName.split('/')[0]}:${\n                github.branchName\n              }`}\n              target=\"_blank\"\n            >\n              View Diff\n            </TinaButton>\n            <TinaButton\n              as=\"a\"\n              primary\n              // @ts-ignore\n              href={fetchedPR.html_url}\n              target=\"_blank\"\n            >\n              View Pull Request\n            </TinaButton>\n          </>\n        )}\n      </ModalActions>\n    </>\n  )\n}\n\nconst TinaButton = styled(RawTinaButton)`\n  height: auto;\n  padding-top: 0.8125rem;\n  padding-bottom: 0.8125rem;\n  text-decoration: none;\n  line-height: 1;\n`\n\nconst ModalDescription = styled.p`\n  margin-bottom: 1rem;\n\n  b {\n    font-weight: bold;\n  }\n`\n\nconst PrModalBody = styled(ModalBody)`\n  padding: 1.25rem 1.25rem 0 1.25rem;\n`\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport styled from 'styled-components'\nimport { Button } from '@tinacms/styles'\n\nexport const ToolbarButton = styled(Button)`\n  display: flex;\n  align-items: center;\n  white-space: nowrap;\n  padding: 0 10px;\n\n  &:focus {\n    outline: none;\n  }\n\n  svg {\n    fill: currentColor;\n    opacity: 0.7;\n    width: 2.5em;\n    height: 2.5em;\n  }\n\n  &:disabled {\n    opacity: 0.6;\n    filter: grayscale(25%);\n  }\n\n  @media (min-width: 1030px) {\n    padding: 0 20px;\n\n    svg {\n      margin-right: 0.25rem;\n    }\n  }\n`\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport styled from 'styled-components'\n\nexport const DesktopLabel = styled.span`\n  display: none;\n  @media (min-width: 1030px) {\n    display: inline;\n  }\n`\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport React, { useState } from 'react'\nimport { Modal, ModalPopup, ModalHeader, ModalBody } from 'tinacms'\nimport { PullRequestIcon } from '@tinacms/icons'\n\nimport { PRModal } from './PRModal'\nimport { ToolbarButton } from '../../components/ToolbarButton'\nimport { DesktopLabel } from '../../components/DesktopLabel'\n\nexport const PullRequestToolbarWidget = {\n  __type: 'toolbar:widget',\n  name: 'create-pr',\n  weight: 5,\n  component: PullRequestButton,\n}\n\nfunction PullRequestButton() {\n  const [opened, setOpened] = useState(false)\n  const close = () => setOpened(false)\n  return (\n    <>\n      <ToolbarButton onClick={() => setOpened(p => !p)}>\n        <PullRequestIcon />\n        <DesktopLabel> Pull Request</DesktopLabel>\n      </ToolbarButton>\n      {opened && (\n        <Modal>\n          <ModalPopup>\n            <ModalHeader close={close}>Pull Request</ModalHeader>\n            <ModalBody>\n              <PRModal />\n            </ModalBody>\n          </ModalPopup>\n        </Modal>\n      )}\n    </>\n  )\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { FieldMeta, useCMS } from 'tinacms'\nimport styled from 'styled-components'\nimport React from 'react'\nimport { GithubClient } from '../github-client'\n\nconst MetaLink = styled.a`\n  display: block;\n  max-width: 250px;\n  overflow: hidden;\n  white-space: nowrap;\n  text-overflow: ellipsis;\n  font-size: var(--tina-font-size-3);\n  line-height: 1.35;\n  color: var(--tina-color-primary-dark);\n`\n\nconst RepoInfo = () => {\n  const cms = useCMS()\n  const github: GithubClient = cms.api.github\n  return (\n    <FieldMeta name={github.isFork ? 'Fork' : 'Repository'}>\n      <MetaLink\n        target=\"_blank\"\n        href={`https://github.com/${github.workingRepoFullName}`}\n      >\n        {github.workingRepoFullName}\n      </MetaLink>\n    </FieldMeta>\n  )\n}\n\nexport const RepoToolbarWidget = {\n  __type: 'toolbar:widget',\n  name: 'repo-info',\n  weight: 1,\n  component: RepoInfo,\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport * as React from 'react'\nimport {\n  Form,\n  Input,\n  useCMS,\n  Modal,\n  ModalPopup,\n  ModalHeader,\n  ModalBody,\n  ModalActions,\n  FormBuilder,\n  FieldsBuilder,\n} from 'tinacms'\nimport { AddIcon, ChevronDownIcon, LockIcon } from '@tinacms/icons'\nimport { Button } from '@tinacms/styles'\nimport { Dismissible } from 'react-dismissible'\nimport styled, { css } from 'styled-components'\nimport { GithubClient, Branch } from '../github-client'\nimport { LoadingDots } from '@tinacms/react-forms'\n\ninterface BranchSwitcherProps {\n  onBranchChange?(branch: string): void\n}\n\nconst BranchSwitcher = ({ onBranchChange }: BranchSwitcherProps) => {\n  const cms = useCMS()\n  const github: GithubClient = cms.api.github\n\n  const [open, setOpen] = React.useState(false)\n  const [confirmSwitchProps, setConfirmSwitchProps] = React.useState<any>()\n  const [createBranchProps, setCreateBranchProps] = React.useState<any>()\n  const [filterValue, setFilterValue] = React.useState('')\n  const selectListRef = React.useRef<HTMLElement>()\n\n  const [branchStatus, setBranchStatus] = React.useState<\n    'pending' | 'loaded' | 'error'\n  >('pending')\n  const [branches, setBranches] = React.useState<Branch[]>([])\n\n  const updateBranchList = React.useCallback(() => {\n    github\n      .getBranchList()\n      .then(branches => {\n        setBranches(branches)\n        setBranchStatus('loaded')\n      })\n      .catch(() => {\n        setBranchStatus('error')\n      })\n  }, [github, setBranches, setBranchStatus])\n\n  React.useEffect(() => {\n    updateBranchList()\n    cms.events.subscribe('github:branch:create', updateBranchList)\n  }, [])\n\n  const closeDropdown = () => {\n    setOpen(false)\n    setFilterValue('')\n    if (selectListRef.current) {\n      selectListRef.current.scrollTop = 0\n    }\n  }\n\n  const openCreateBranchModal = () => {\n    setCreateBranchProps({ name: filterValue })\n    closeDropdown()\n  }\n\n  const filteredBranches = branches.filter(option => {\n    return option.name.includes(filterValue)\n  })\n\n  return (\n    <>\n      <SelectWrapper>\n        <SelectBox onClick={() => setOpen(!open)} open={open}>\n          <SelectLabel>Branch</SelectLabel>\n          <SelectCurrent>{github.branchName}</SelectCurrent>\n          <ChevronDownIcon />\n        </SelectBox>\n        <SelectDropdown open={open}>\n          <Dismissible click escape disabled={!open} onDismiss={closeDropdown}>\n            <DropdownHeader>\n              <SelectFilter\n                placeholder=\"Filter\"\n                onChange={event => setFilterValue(event.target.value)}\n                value={filterValue}\n              />\n            </DropdownHeader>\n            <SelectList ref={selectListRef as any}>\n              {branchStatus === 'pending' && (\n                <SelectLoadingState>\n                  <LoadingDots color=\"var(--tina-color-primary)\" />\n                </SelectLoadingState>\n              )}\n              {branchStatus === 'loaded' && (\n                <>\n                  {filteredBranches.map(option => (\n                    <SelectOption\n                      key={option.name}\n                      active={option.name === github.branchName}\n                      onClick={() => {\n                        setConfirmSwitchProps(option)\n                        closeDropdown()\n                      }}\n                    >\n                      {option.protected && <LockIcon />} {option.name}\n                    </SelectOption>\n                  ))}\n                  {filteredBranches.length === 0 && (\n                    <SelectEmptyState>No branches to display.</SelectEmptyState>\n                  )}\n                </>\n              )}\n              {branchStatus === 'error' && (\n                <SelectEmptyState>\n                  We had trouble loading branches. Please refresh to try again.\n                </SelectEmptyState>\n              )}\n            </SelectList>\n            <DropdownActions>\n              <CreateButton onClick={openCreateBranchModal}>\n                <AddIcon /> New Branch\n              </CreateButton>\n            </DropdownActions>\n          </Dismissible>\n        </SelectDropdown>\n      </SelectWrapper>\n      {createBranchProps && (\n        <CreateBranchModal\n          current={github.branchName}\n          name={createBranchProps.name}\n          onBranchChange={(name: string) => {\n            if (onBranchChange) {\n              onBranchChange(name)\n            }\n            setCreateBranchProps(null)\n          }}\n          close={() => {\n            setCreateBranchProps(null)\n          }}\n        />\n      )}\n      {confirmSwitchProps && (\n        <ConfirmSwitchBranchModal\n          name={confirmSwitchProps.name}\n          onBranchChange={() => {\n            cms.alerts.info('Switched to branch ' + confirmSwitchProps.name)\n            github.setWorkingBranch(confirmSwitchProps.name)\n            closeDropdown()\n            if (onBranchChange) {\n              onBranchChange(confirmSwitchProps.name)\n            }\n            setConfirmSwitchProps(null)\n            setCreateBranchProps(null)\n            cms.events.dispatch({\n              type: 'github:branch:checkout',\n              branchName: confirmSwitchProps.name,\n            })\n          }}\n          close={() => {\n            setConfirmSwitchProps(null)\n          }}\n        />\n      )}\n    </>\n  )\n}\n\nconst CreateBranchModal = ({ current, name, onBranchChange, close }: any) => {\n  const cms = useCMS()\n\n  const form: Form = React.useMemo(\n    () =>\n      new Form({\n        label: 'create-branch',\n        id: 'create-branch-id',\n        initialValues: {\n          name,\n        },\n        fields: [{ label: 'Branch Name', name: 'name', component: 'text' }],\n        async onSubmit({ name }) {\n          try {\n            await cms.api.github.createBranch(name)\n            cms.events.dispatch({\n              type: 'github:branch:create',\n              branchName: name,\n            })\n            cms.api.github.setWorkingBranch(name)\n            cms.events.dispatch({\n              type: 'github:branch:checkout',\n              branchName: name,\n            })\n            if (onBranchChange) {\n              onBranchChange(name)\n            }\n          } catch (error) {\n            cms.events.dispatch({ type: 'github:error', error })\n          }\n        },\n      }),\n    [cms]\n  )\n\n  return (\n    <Modal>\n      <FormBuilder form={form}>\n        {({ handleSubmit }) => {\n          return (\n            <ModalPopup>\n              <ModalHeader close={close}>Create Branch</ModalHeader>\n              <ModalBody\n                onKeyPress={e =>\n                  e.charCode === 13 ? (handleSubmit() as any) : null\n                }\n              >\n                <FieldsBuilder form={form} fields={form.fields} />\n                <ModalText>\n                  <p>\n                    Create branch&nbsp;<BranchName>{name}</BranchName>&nbsp;from\n                    '{current}'\n                  </p>\n                </ModalText>\n              </ModalBody>\n              <ModalActions>\n                <Button onClick={close}>Cancel</Button>\n                <Button onClick={handleSubmit} primary>\n                  Create\n                </Button>\n              </ModalActions>\n            </ModalPopup>\n          )\n        }}\n      </FormBuilder>\n    </Modal>\n  )\n}\n\nconst ConfirmSwitchBranchModal = ({ name, onBranchChange, close }: any) => {\n  return (\n    <Modal>\n      <ModalPopup>\n        <ModalHeader close={close}>Switch Branch</ModalHeader>\n        <ModalBody\n          padded={true}\n          onKeyPress={e =>\n            e.charCode === 13 ? (onBranchChange() as any) : null\n          }\n        >\n          <p>\n            Are you sure you want to switch to branch{' '}\n            <BranchName>{name}</BranchName>?\n          </p>\n        </ModalBody>\n        <ModalActions>\n          <Button onClick={close}>Cancel</Button>\n          <Button onClick={onBranchChange} primary>\n            Switch Branch\n          </Button>\n        </ModalActions>\n      </ModalPopup>\n    </Modal>\n  )\n}\n\nconst ModalText = styled.div`\n  padding: 0 var(--tina-padding-big) var(--tina-padding-big)\n    var(--tina-padding-big);\n`\n\nconst SelectFilter = styled(Input)`\n  height: 36px;\n  flex: 0 1 auto;\n\n  ::placeholder {\n    color: var(--tina-color-grey-4);\n  }\n`\n\nconst CreateButton = styled(Button)`\n  display: flex;\n  align-items: center;\n  height: 36px;\n\n  svg {\n    width: 24px;\n    margin-right: 4px;\n    opacity: 0.7;\n  }\n`\n\nconst BranchName = styled.span`\n  font-weight: bold;\n  color: var(--tina-color-primary);\n`\n\nconst DropdownActions = styled.div`\n  background-color: var(--tina-color-grey-1);\n  border-top: 1px solid var(--tina-color-grey-2);\n  padding: var(--tina-padding-small);\n`\n\nconst DropdownHeader = styled.div`\n  padding: var(--tina-padding-small);\n  border-bottom: 1px solid var(--tina-color-grey-2);\n`\n\nconst SelectEmptyState = styled.div`\n  display: block;\n  border: none;\n  outline: none;\n  padding: var(--tina-padding-small);\n  background: transparent;\n  color: var(--tina-color-grey-4);\n  text-align: left;\n  font-size: var(--tina-font-size-2);\n  line-height: 1.4;\n  width: 100%;\n  transition: all 150ms ease-out;\n  flex: 0 0 auto;\n`\n\nconst SelectLoadingState = styled.div`\n  display: flex;\n  border: none;\n  outline: none;\n  padding: var(--tina-padding-small);\n  background: transparent;\n  width: 100%;\n  justify-content: center;\n  align-items: center;\n  flex: 0 0 auto;\n`\n\nexport interface SelectOptionProps {\n  active?: boolean\n}\n\nconst SelectOption = styled.button<SelectOptionProps>`\n  display: lock;\n  border: none;\n  outline: none;\n  padding: 4px var(--tina-padding-small);\n  background: transparent;\n  color: var(--tina-color-grey-6);\n  text-align: left;\n  font-size: var(--tina-font-size-2);\n  line-height: 1.2;\n  white-space: nowrap;\n  width: 100%;\n  cursor: pointer;\n  transition: all 150ms ease-out;\n  text-overflow: ellipsis;\n  max-width: 100%;\n  overflow: hidden;\n  flex: 0 0 auto;\n\n  svg {\n    width: 20px;\n    height: auto;\n    margin: -4px -4px -4px -4px;\n    fill: currentColor;\n    opacity: 0.7;\n  }\n\n  :first-child {\n    padding-top: 8px;\n  }\n\n  :last-child {\n    padding-bottom: 8px;\n  }\n\n  :hover {\n    color: var(--tina-color-primary);\n    background-color: var(--tina-color-grey-1);\n  }\n\n  ${p =>\n    p.active &&\n    css`\n      font-weight: bold;\n      color: var(--tina-color-primary);\n      background-color: var(--tina-color-grey-1);\n      pointer-events: none;\n    `};\n`\n\nconst SelectList = styled.div`\n  min-width: 200px;\n  max-height: 170px;\n  overflow-y: scroll;\n  display: flex;\n  flex-direction: column;\n  justify-content: flex-start;\n  align-items: stretch;\n`\n\nconst SelectWrapper = styled.div`\n  position: relative;\n`\n\nexport interface SelectDropdownProps {\n  open?: boolean\n}\n\nconst SelectDropdown = styled.div<SelectDropdownProps>`\n  position: absolute;\n  bottom: -4px;\n  left: 50%;\n  transform: translate3d(-50%, calc(100% - 16px), 0) scale3d(0.5, 0.5, 1);\n  border-radius: var(--tina-radius-small);\n  border: 1px solid var(--tina-color-grey-2);\n  box-shadow: var(--tina-shadow-big);\n  background-color: white;\n  transform-origin: 50% 0;\n  pointer-events: none;\n  transition: all 150ms ease-out;\n  opacity: 0;\n  width: 350px;\n\n  &:before {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 0;\n    left: 50%;\n    transform: translate3d(-50%, -100%, 0);\n    width: 0;\n    height: 0;\n    border-left: 10px solid transparent;\n    border-right: 10px solid transparent;\n    border-bottom: 10px solid var(--tina-color-grey-2);\n  }\n\n  &:after {\n    content: '';\n    display: block;\n    position: absolute;\n    top: 1px;\n    left: 50%;\n    transform: translate3d(-50%, -100%, 0);\n    width: 0;\n    height: 0;\n    border-left: 10px solid transparent;\n    border-right: 10px solid transparent;\n    border-bottom: 10px solid white;\n  }\n\n  ${p =>\n    p.open &&\n    css`\n      opacity: 1;\n      pointer-events: auto;\n      transform: translate3d(-50%, 100%, 0) scale3d(1, 1, 1);\n    `};\n`\n\nexport interface SelectBoxProps {\n  open: boolean\n}\n\nconst SelectBox = styled.button<SelectBoxProps>`\n  border-radius: var(--tina-radius-small);\n  border: 1px solid var(--tina-color-grey-2);\n  background-color: white;\n  padding: 5px 42px 5px var(--tina-padding-small);\n  position: relative;\n  outline: none;\n  cursor: pointer;\n  min-width: 140px;\n  transition: all 150ms ease-out;\n\n  :hover {\n    background-color: var(--tina-color-grey-1);\n  }\n\n  svg {\n    fill: var(--tina-color-primary);\n    position: absolute;\n    top: 50%;\n    right: 8px;\n    transform-origin: 50% 50%;\n    transform: translate3d(0, -50%, 0);\n    transition: all 150ms ease-out;\n    width: 24px;\n    height: auto;\n  }\n\n  ${p =>\n    p.open &&\n    css`\n      background-color: var(--tina-color-grey-1);\n      box-shadow: inset 0px 2px 3px rgba(0, 0, 0, 0.06);\n\n      ${SelectLabel} {\n        color: var(--tina-color-primary);\n      }\n\n      svg {\n        transform: translate3d(0, -50%, 0) rotate(180deg);\n        fill: var(--tina-color-grey-4);\n      }\n    `};\n`\n\nconst SelectLabel = styled.span`\n  color: var(--tina-color-grey-8);\n  display: block;\n  letter-spacing: 0.01em;\n  line-height: 1;\n  font-size: var(--tina-font-size-1);\n  font-weight: 600;\n  text-align: left;\n  transition: all 150ms ease-out;\n`\n\nconst SelectCurrent = styled.span`\n  color: var(--tina-color-grey-6);\n  display: block;\n  text-align: left;\n  line-height: 20px;\n  font-size: var(--tina-font-size-3);\n  text-overflow: ellipsis;\n  max-width: 250px;\n  white-space: nowrap;\n  overflow: hidden;\n`\n\nexport const BranchSwitcherPlugin = {\n  __type: 'toolbar:widget',\n  name: 'branch-switcher',\n  weight: 1,\n  component: BranchSwitcher,\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport * as React from 'react'\nimport {\n  Modal,\n  ModalPopup,\n  ModalHeader,\n  ModalBody,\n  ModalActions,\n} from '@tinacms/react-modals'\nimport { ActionButton } from '@tinacms/react-forms'\nimport { useCMS } from '@tinacms/react-core'\nimport { Button } from '@tinacms/styles'\nimport { Form } from '@tinacms/forms'\n\nconst getTitleDefault = (form: Form) => {\n  return form.name\n}\n\ninterface options {\n  getTitle?: (form: Form) => string\n  getFilePath?: (form: Form) => string\n}\n\n/**\n * This function returns an action that can but used in a form to delete files in github.\n *\n * Options\n * getTitle: a function that takes in a form and returns a title of the file to be deleted (optional)\n * getFilePath: a function that takes in a form and returns a the file path in github (optional)\n *\n * EXAMPLE\n * const deleteAction = createGithubDeleteAction()\n *\n * const formOptions = {\n *    actions: [deleteAction, ...]\n *    //..\n * }\n * const [data, form] = useGithubJsonForm(file, formOptions);\n * usePlugin(form);\n *\n * NOTE: this will delete the entire file that is used to store the form data. The primary use case would be dynamic page content like blog posts.\n *\n */\nexport const createGithubDeleteAction = (\n  { getTitle = getTitleDefault, getFilePath = getTitleDefault }: options = {\n    getTitle: getTitleDefault,\n    getFilePath: getTitleDefault,\n  }\n) => {\n  const DeleteAction = ({ form }: { form: Form }) => {\n    const cms = useCMS()\n    const [active, setActive] = React.useState(false)\n    const open = () => setActive(true)\n    const close = () => setActive(false)\n    const title = getTitle!(form)\n    const filePath = getFilePath!(form)\n\n    return (\n      <React.Fragment>\n        <ActionButton onClick={open}>{`Delete ${title}`}</ActionButton>\n        {active && (\n          <Modal>\n            <ModalPopup>\n              <ModalHeader close={close}>{`Delete ${title}`} </ModalHeader>\n              <ModalBody>\n                {`Are you sure you want to delete ${title}`}\n              </ModalBody>\n              <ModalActions>\n                <Button\n                  onClick={async () => {\n                    try {\n                      close()\n                      await cms.api.github.delete!(filePath)\n                    } catch (error) {\n                      close()\n                      console.error(error)\n                    } finally {\n                      window.history.back()\n                    }\n                  }}\n                >\n                  Yes\n                </Button>\n                <Button onClick={close}>No</Button>\n              </ModalActions>\n            </ModalPopup>\n          </Modal>\n        )}\n      </React.Fragment>\n    )\n  }\n\n  return DeleteAction\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { GitFile } from './useGitFileSha'\nimport { useCMS, useForm, FormOptions } from 'tinacms'\nimport { FORM_ERROR } from 'final-form'\nimport { GithubClient, useGithubFile } from '../github-client'\n\nexport interface GithubFormOptions extends Partial<FormOptions<any>> {\n  serialize: (data: any) => string\n}\n\nexport const useGithubFileForm = <T = any>(\n  file: GitFile<T>,\n  options: GithubFormOptions\n) => {\n  const cms = useCMS()\n  const githubFile = useGithubFile({\n    path: file.fileRelativePath,\n    serialize: options.serialize,\n  })\n\n  const [formData, form] = useForm({\n    id: file.fileRelativePath,\n    label: options.label || file.fileRelativePath,\n    initialValues: file.data,\n    fields: options.fields || [],\n    actions: options.actions || [],\n    onSubmit(formData) {\n      const github: GithubClient = cms.api.github\n      return githubFile\n        .commit(formData)\n        .then(() => {\n          cms.alerts.success(\n            `Saved Successfully: Changes committed to ${github.workingRepoFullName}`\n          )\n        })\n        .catch((error: any) => {\n          return { [FORM_ERROR]: error }\n        })\n    },\n  })\n\n  return [formData || file.data, form]\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { FormOptions, Field } from 'tinacms'\nimport { GitFile } from './useGitFileSha'\nimport { useGithubFileForm } from './useGithubFileForm'\n\ninterface Options {\n  id?: string\n  label?: string\n  fields?: Field[]\n  actions?: FormOptions<any>['actions']\n}\n\nconst serialize = (formData: any) => {\n  return JSON.stringify(formData, null, 2)\n}\n\nexport function useGithubJsonForm(jsonFile: GitFile, formOptions?: Options) {\n  return useGithubFileForm(jsonFile, {\n    ...formOptions,\n    serialize,\n  })\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { MediaStore, MediaUploadOptions, Media } from 'tinacms'\nimport { GithubClient } from '../github-client'\nimport base64File from './base64File'\n\nexport class GithubMediaStore implements MediaStore {\n  accept = '*'\n\n  constructor(private githubClient: GithubClient) {\n    //\n  }\n\n  async persist(files: MediaUploadOptions[]): Promise<Media[]> {\n    const uploaded: Media[] = []\n    for (const { file, directory } of files) {\n      const path =\n        directory.charAt(0) === '/'\n          ? (directory + file.name).slice(1) // drop the first '/'\n          : directory + file.name\n\n      try {\n        const content = (await base64File(file)).toString().split(',')[1] // only need the data piece\n        await this.githubClient.upload(path, content, 'Upload', true)\n\n        uploaded.push({\n          directory: directory,\n          filename: file.name,\n        })\n      } catch (e) {\n        console.warn('Failed to upload content to Github: ' + e)\n      }\n    }\n\n    return uploaded\n  }\n\n  async previewSrc(src: string) {\n    try {\n      return this.githubClient.getDownloadUrl(src)\n    } catch {\n      return src\n    }\n  }\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nexport default function base64File(file: Blob): Promise<string | ArrayBuffer> {\n  return new Promise(resolve => {\n    const reader = new FileReader()\n    reader.readAsDataURL(file)\n    reader.onload = () => {\n      if (reader.result) {\n        resolve(reader.result)\n      } else {\n        throw new Error('base64File: No result')\n      }\n    }\n  })\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { useEffect } from 'react'\nimport { GITHUB_AUTH_CODE_KEY } from '../github-client'\n\nexport const useGithubAuthRedirect = () => {\n  useEffect(() => {\n    const urlParams = new URLSearchParams(window.location.search)\n    const code = urlParams.get('code')\n\n    localStorage[GITHUB_AUTH_CODE_KEY] = code\n  }, [])\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { FormOptions, Field } from 'tinacms'\nimport { GitFile } from './useGitFileSha'\nimport { toMarkdownString } from 'next-tinacms-markdown'\nimport { useGithubFileForm } from './useGithubFileForm'\ninterface Options {\n  id?: string\n  label?: string\n  fields?: Field[]\n  actions?: FormOptions<any>['actions']\n}\n\nexport function useGithubMarkdownForm(\n  markdownFile: GitFile,\n  formOptions?: Options\n) {\n  return useGithubFileForm(markdownFile, {\n    ...formOptions,\n    serialize: toMarkdownString,\n  })\n}\n","/**\n\nCopyright 2019 Forestry.io Inc\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\nimport { usePlugins } from 'tinacms'\nimport { PullRequestToolbarWidget } from './pull-request'\nimport { RepoToolbarWidget } from './RepoInfoPlugin'\nimport { BranchSwitcherPlugin } from './BranchSwitcherPlugin'\n\nexport const useGithubToolbarPlugins = () => {\n  usePlugins([\n    RepoToolbarWidget,\n    PullRequestToolbarWidget,\n    BranchSwitcherPlugin,\n  ])\n}\n"],"names":["_Pact","prototype","then","onFulfilled","onRejected","result","state","this","s","callback","_settle","v","e","o","_this","value","pact","bind","observer","_isSettledPact","thenable","_iteratorSymbol","Symbol","iterator","_catch","body","recover","asyncIterator","btoa","require","b64EncodeUnicode","str","encodeURIComponent","replace","_match","p1","String","fromCharCode","parseInt","authenticate","clientId","codeExchangeRoute","scope","authState","Math","random","toString","substring","url","Promise","resolve","authTab","window","addEventListener","key","fetch","newValue","response","json","data","token","signedToken","localStorage","setItem","console","warn","close","title","w","h","open","top","outerHeight","screenY","outerWidth","screenX","popupWindow","removeLeadingSlash","path","charAt","GithubClient","authCallbackRoute","baseRepoFullName","baseBranch","authScope","proxy","validate","isAuthenticated","getUser","isAuthorized","getRepository","repo","permissions","push","_this3","req","method","status","workingRepoFullName","createFork","_this5","fork","setCookie","WORKING_REPO_COOKIE_KEY","full_name","createPR","headBranch","branchName","head","split","base","setWorkingRepoFullName","repoFullName","setWorkingBranch","branch","HEAD_BRANCH_COOKIE_KEY","fetchExistingPR","_this7","branches","i","length","pull","ref","getBranch","_this9","getBranchList","createBranch","name","log","_this13","currentBranch","sha","object","commit","filePath","fileContents","commitMessage","message","content","getDownloadUrl","fetchFile","res","download_url","decoded","request","atob","githubFileApi","encoded","_this21","upload","_this27","proxyRequest","getGithubResponse","GithubError","statusText","errors","Error","createErrorMessage","getItem","headers","Headers","append","JSON","stringify","getCookie","cookieName","Cookies","get","val","set","sameSite","map","error","join","GithubFile","cms","parse","serialize","api","github","retryOnConflict","serializedContent","_this2","events","dispatch","type","useGithubFile","useCMS","useMemo","AsyncButton","primary","action","useState","submitting","setSubmitting","onClick","useCallback","React","Button","busy","disabled","LoadingDots","GithubAuthenticationModal","onAuthSuccess","ModalBuilder","actions","CreateForkModal","onForkCreated","setError","modalProps","StyleReset","Modal","ModalPopup","ModalHeader","ModalBody","padded","ErrorLabel","ModalActions","styled","p","_templateObject","ActionableModal","TinaButton","GithubErrorModal","props","errorModalProps","setErrorModalProps","useEffect","githubClient","startEditing","stopEditing","cancelEditModeAction","reauthenticateAction","switchToMaster","discriminant","cases","awaitBody","dispatchIndex","outer","test","testValue","fallthroughCheck","reject","_resumeAfterBody","_resumeAfterTest","getModalProps","enable","disable","useCMSEvent","event","deps","subscribe","PRModal","prError","setPrError","undefined","fetchedPR","setFetchedPR","titleInput","createRef","bodyInput","checkForPR","id","PrModalBody","ModalDescription","workingBranch","isFork","target","href","FieldMeta","label","Input","TextArea","current","html_url","as","RawTinaButton","_templateObject2","_templateObject3","ToolbarButton","DesktopLabel","span","PullRequestToolbarWidget","__type","weight","component","opened","setOpened","PullRequestIcon","MetaLink","a","RepoToolbarWidget","CreateBranchModal","onBranchChange","form","Form","initialValues","fields","onSubmit","FormBuilder","handleSubmit","onKeyPress","charCode","FieldsBuilder","ModalText","BranchName","ConfirmSwitchBranchModal","div","SelectFilter","CreateButton","_templateObject4","DropdownActions","_templateObject5","DropdownHeader","_templateObject6","SelectEmptyState","_templateObject7","SelectLoadingState","_templateObject8","SelectOption","button","_templateObject9","active","css","SelectList","_templateObject11","SelectWrapper","_templateObject12","SelectDropdown","_templateObject13","SelectBox","_templateObject15","SelectLabel","_templateObject17","SelectCurrent","_templateObject18","BranchSwitcherPlugin","setOpen","confirmSwitchProps","setConfirmSwitchProps","createBranchProps","setCreateBranchProps","filterValue","setFilterValue","selectListRef","branchStatus","setBranchStatus","setBranches","updateBranchList","closeDropdown","scrollTop","filteredBranches","filter","option","includes","ChevronDownIcon","Dismissible","click","escape","onDismiss","placeholder","onChange","color","LockIcon","AddIcon","alerts","info","getTitleDefault","useGithubFileForm","file","options","githubFile","fileRelativePath","useForm","formData","success","FORM_ERROR","GithubMediaStore","persist","files","uploaded","check","step","_cycle","next","done","_fixup","TypeError","values","array","_forTo","directory","slice","reader","FileReader","readAsDataURL","onload","base64File","_base64File","filename","previewSrc","src","children","onLogin","onLogout","previewError","activeModal","setActiveModal","onClose","getTitle","getFilePath","setActive","ActionButton","finalizer","history","back","code","URLSearchParams","location","search","jsonFile","formOptions","markdownFile","toMarkdownString","usePlugins"],"mappings":"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"}